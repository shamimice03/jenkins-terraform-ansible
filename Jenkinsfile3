pipeline {
    agent any
    environment{
        GITHUB_CRED = credentials('github')
    }
    stages {
        stage('Cloning') {
            steps {
                checkout scmGit(branches: [[name: '*/main']], extensions: [], userRemoteConfigs: [[url: 'https://github.com/shamimice03/terraform-ansible-jenkins.git']])
            }
        }
         stage('Ansible-Install docker on remote hosts') {
            agent {label 'aws'}
            steps {
                ansiblePlaybook credentialsId: 'ec2-ssh-key', disableHostKeyChecking: true, installation: 'ansible', inventory: 'static_inventory', playbook: 'docker_installation_playbook.yaml'            }
        }
    }
}

